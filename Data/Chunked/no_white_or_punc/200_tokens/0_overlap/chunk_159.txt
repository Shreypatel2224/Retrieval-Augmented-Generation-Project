back the transaction if there are insufficient funds ROLLBACK SIGNAL SQLSTATE 45000 SET MESSAGETEXT  rollbackmessage ELSE  Log the transactions if there are sufficient funds INSERT INTO transactions